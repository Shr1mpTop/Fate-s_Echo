# 🌌 世界观设定 (World Setting)

## 1. 故事背景：以太深渊 (The Ether Abyss)
在区块链的数字荒原之下，存在着一个无限延伸的**"以太深渊"**。传说深渊的最深处埋藏着创世区块遗留的无穷算力与财富（Jackpot）。

无数的**"链上行者 (Chain Walkers)"** 试图利用智能合约的力量召唤英灵，组成军团深入地下。然而，由于计算资源（Gas）的稀缺，每一次召唤和行动都伴随着昂贵的代价。此外，深渊本身具有自我意识（Chainlink VRF），它变幻莫测，时而给予馈赠，时而通过"灾厄骰子"吞噬贪婪者的灵魂。

这里的规则很简单：**活下去，或者归零 (HODL or Rekt)。**

## 2. 阵营设定 (Factions)

为了简化初期开发，暂不通过复杂的种族克制来区分，而是通过视觉风格和基础属性倾向来区分两大对立面。

### 🔴 敌方：深渊梦魇 (The Glitch Nightmare)
深渊系统自动生成的守卫者，它们是过去失败探索者的残留数据碎片重组而成的怪物。
*   **风格关键词**：赛博故障风 (Glitch Art)、紫黑色调、乱码、骷髅。
*   **特点**：属性随层数指数级增长，每一层都会生成完全随机的阵容。

### 🔵 己方：创世军团 (Genesis Legion)
玩家花费代币从以太网络中召唤的英灵。
*   **风格关键词**：像素风 (Pixel Art)、未来战士、复古奇幻混合。
*   **特点**：作为 NFT 或临时数据存在，拥有固定的 ID 和属性。

---
# 🃏 卡牌与单位设定 (Units & Cards)

## 1. 基础属性 (Stats)
为了符合“轻量化”要求，所有单位仅拥有两个核心数值：
*   **⚔️ 攻击力 (ATK)**: 对敌人造成的单次伤害值。
*   **🛡️ 生命值 (HP)**: 单位能承受的总伤害。当 HP ≤ 0 时，单位死亡（移出队列）。

## 2. 单位图鉴 (Unit Registry) - 第一期

我们设计 3 种基础职业原型，通过不同的属性配比体现策略差异。

| ID | 名称 (Name) | 职业类型 | 初始 ATK | 初始 HP | 描述/策略定位 |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **#01** | **铁壁卫士** (Iron Guard) | 🛡️ 坦克 | 2 | 20 | **生存优先**。攻击力极低，但血量极厚。**最佳站位：前排**，用于吸收第一波伤害。 |
| **#02** | **暗影刺客** (Shadow Blade) | ⚔️ 输出 | 8 | 4 | **高攻纸皮**。能快速秒杀敌人，但被摸一下就死。**最佳站位：中/后排**，需要坦克保护。 |
| **#03** | **均衡骑士** (Noble Knight) | ⚖️ 战士 | 4 | 10 | **万金油**。属性均衡，适合应对未知情况或作为副坦。 |
| **#04** | **暴怒狂战士** (Berserker) | ⚔️ 爆发 | 6 | 8 | 中等血量，较高攻击，用于撕裂对方前排。 |
| **#99** | **创世巨龙** (Genesis Dragon) | 👑 隐藏款 | 15 | 30 | **SSR**。极其稀有（抽取概率 0.1%），抽到几乎等于保送前 10 关。 |

---
# ⚔️ 战斗与博弈机制 (Gameplay & Mechanics)

## 1. 卡牌闯关 (The Siege)

### 触发条件
*   玩家点击 "Start Run" 并支付 Token 后触发 Level 1。
*   每通过一关，选择 "Next Level" 触发下一关。

### 战斗流程 (链上逻辑)
1.  **备战阶段**：
    *   玩家看到当前关卡的层数（例如 Floor 3）。
    *   玩家查看自己手牌的剩余血量状态。
    *   **排兵布阵**：玩家提交一个数组 `[ID_A, ID_B, ID_C]` 决定出场顺序。
2.  **遭遇阶段**：
    *   合约根据 `Level` 和 `RandomSeed` 生成敌方队列。
    *   *公式*：敌方总战力 ≈ 玩家初始战力 * (1.1 ^ Level)。
3.  **对撞阶段 (Auto-Battle)**：
    *   采用 **"队列轮替制"**：
    *   **Round 1**: 玩家通过阵容索引 `0` 的单位 vs 敌方索引 `0` 的单位。
    *   **伤害结算**: 双方同时扣血。`P.HP -= E.ATK`，`E.HP -= P.ATK`。
    *   **死亡判定**:
        *   若某方单位 HP ≤ 0，则该单位**立即退场**。
        *   若双方同归于尽，双方下一位补位。
        *   若一方死，另一方存活，则存活者继续迎战对方下一位（保持当前残血状态）。
4.  **结束判定**:
    *   **胜利**: 敌方队列清空。玩家获得奖励系数，进入下一层。
    *   **失败**: 玩家队列清空。游戏结束，资金归零。

## 2. 命运转盘 (Wheel of Fate) - 骰子博弈

### 触发机制
*   **强制触发**：每通过 **3** 个关卡（即完成 Level 3, 6, 9... 的战斗后），玩家不能直接进入下一层，必须先进入命运房间。

### 骰子设定
*   **形式**：通过 Chainlink VRF 生成的一个 **1-100** 的整数。
*   **事件表**：

| 骰子点数 | 事件名称 | 效果详情 |
| :--- | :--- | :--- |
| **1 - 10** | **☠️ 深渊凝视 (Cursed)** | **【大凶】** 扣除当前累计奖金池的 **20%**。 |
| **11 - 50** | **💤 寂静时刻 (Silence)** | **【平庸】** 无事发生，稍作休息。 |
| **51 - 85** | **💰 贪婪馈赠 (Greed)** | **【吉】** 当前累计奖金池增加了 **10%** 的奖励。 |
| **86 - 98** | **❤️ 泉水祝福 (Blessing)** | **【大吉】** 所有存活单位的生命值 **完全恢复 (Heal Full)**。 |
| **99 - 100** | **🎰 命运大奖 (The Jackpot)** | **【奇迹】** 获得一张额外的随机卡牌加入队伍（增强兵力）。 |

---
# 🛠️ 技术栈与架构 (Tech Stack)

## 1. 游戏引擎与前端
由于是“轻量化”链游，我们不使用 Unity/Unreal，而是使用 **Web 技术栈**。
*   **框架**: **Next.js (React)**。轻量、响应式，非常适合这种卡牌+UI为主的游戏。
*   **动画库**: **Framer Motion**。用于制作卡牌翻转、血条扣减、骰子滚动的平滑动画。
*   **状态管理**: **Redux** 或 **Zustand**。管理前端的战斗回放状态。

## 2. 智能合约 (Smart Contracts)
*   **开发框架**: **Foundry** (Solidity)。速度快，测试方便。
*   **部署网络**: **Arbitrum Sepolia** 或 **Base Sepolia**（Gas 费低，适合高频交互测试）。
*   **合约架构**:
    *   `CardRegistry.sol`: 存储卡牌数据的“静态数据库”。
    *   `EtherDungeon.sol`: 核心逻辑。处理 `battle()`, `rollDice()`, `cashOut()`。
    *   `VRFConsumer`: 专门对接 Chainlink。

## 3. 随机数方案
*   **Chainlink VRF V2.5**。
    *   用于：初始抽卡、命运骰子、每层敌人生成种子。
    *   **模式**: Subscription 模式 (预充值 Link 代币)。
